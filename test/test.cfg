process Gen = {
	untracked PSet maxEvents = { untracked int32 input = 100 }

	untracked PSet configurationMetadata = {
		untracked string version = "alpha"
		untracked string name = "LHEF input"
		untracked string annotation = "hidden valley"
	}

	service = RandomNumberGeneratorService  {
		untracked uint32 sourceSeed = 123456789
		PSet moduleSeeds = {
			untracked uint32 VtxSmeared = 98765432
		}
	}

	include "FWCore/MessageService/data/MessageLogger.cfi"
	replace MessageLogger.cerr.threshold = "INFO"

#	untracked PSet options = {
#		include "FWCore/Framework/test/cmsExceptionsFatalOption.cff"
#		untracked bool wantSummary = true
#		untracked bool makeTriggerResults = true
#	}

	source = LHESource {
		vstring inputFiles = {
			"hidden-valley.lhe"
		}

		PSet hadronisation = {
			string generator = "Pythia6"

			untracked int32	pythiaPylistVerbosity = 2
			untracked int32	maxEventsToPrint = 1

			vstring parameterSets = {
				"pythiaCMSDefaults"
#,
#				"pythiaHiddenValley"
			}

			vstring pythiaCMSDefaults = {
				'PMAS(5,1)=4.4   ! b quarks mass',
				'PMAS(6,1)=172.3 ! t quarks mass',
				'MSTJ(11)=3     ! Choice of the fragmentation function',
				'MSTJ(22)=2     ! Decay those unstable particles',
				'PARJ(71)=10 .  ! for which ctau  10 mm',
				'MSTP(2)=1      ! which order running alphaS',
				'MSTP(33)=0     ! no K factors in hard cross sections',
				'MSTP(51)=7     ! structure function chosen',
				'MSTP(81)=1     ! multiple parton interactions 1 is Pythia default',
				'MSTP(82)=4     ! Defines the multi-parton model',
				'MSTU(21)=1     ! Check on possible errors during program execution',
				'PARP(82)=1.9   ! pt cutoff for multiparton interactions',
				'PARP(89)=1000. ! sqrts for which PARP82 is set',
				'PARP(83)=0.5   ! Multiple interactions: matter distrbn parameter',
				'PARP(84)=0.4   ! Multiple interactions: matter distribution parameter',
				'PARP(90)=0.16  ! Multiple interactions: rescaling power',
				'PARP(67)=1.    ! amount of initial-state radiation',
				'PARP(85)=0.33  ! gluon prod. mechanism in MI',
				'PARP(86)=0.66  ! gluon prod. mechanism in MI',
				'PARP(87)=0.7   ! ',
				'PARP(88)=0.5   ! ',
				'PARP(91)=1.0   ! kt distribution',
				'MSEL=0         ! User defined processes/Full user control'
			}

			vstring pythiaHiddenValley = {
				'PMAS(C6000111,1)=  12.5671034 !vpi0',
				'PMAS(C6000111,4)=  13.068     !',
				'PMAS(C6000211,1)=  12.9944483 !vpi+',
				'PMAS(C6000211,4)=  0.         !',
				'MDCY(C6000211,1)=  0          !'
			}
		 }
	}

	include "Configuration/StandardSequences/data/VtxSmearedGauss.cff"
	include "Configuration/StandardSequences/data/Generator.cff"

	replace genParticles.abortOnUnknownPDGCode = false

	include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"

	path p0 = { pgen }

	include "Configuration/EventContent/data/EventContent.cff"

	module printList = ParticleListDrawer {
		untracked int32 maxEventsToPrint = -1
	}

	module printTree = ParticleTreeDrawer {
		InputTag src = genParticleCandidates
		untracked bool printP4 = false
		untracked bool printPtEtaPhi = false
		untracked bool printVertex = true
		untracked bool printStatus = false
		untracked bool printIndex = false
		untracked vint32 status = { 1, 2, 3 }
	}

#	path p = {
#		printTree,
#		printList
#	}

	module GEN = PoolOutputModule { 
		using FEVTSIMEventContent
		untracked string fileName = "test.root"
		untracked PSet dataset = {
			untracked string dataTier = "GEN"
		}
	}

	endpath outpath = { GEN }

	schedule = { p0, outpath }
}
